---
title: "R Notebook"
output: html_notebook
---



```{r}
library(data.table)     # Run once per session
library(ggplot2)        # Run once per session
library(igraph)         # Run once per session

dt.trade <- fread("../../data/cleaned_trade_data.csv")
dt.trade
```


```{r}
# Set the parameters
dt.trade.country <- dt.trade[reporter_name == "Afghanistan"]
dt.trade.country.year <- dt.trade.country[year == 2017]

# Set the vertices
dt.all.reporters <- dt.trade.country.year[, list(name=unique(reporter_name), type=FALSE)]
dt.all.partners <- dt.trade.country.year[, list(name=unique(partner_name), type=TRUE)]
dt.all.vertices <- rbind(dt.all.reporters, dt.all.partners)

# Create & plot the graph
g <- graph.data.frame(dt.trade.country.year[, list(reporter_name, partner_name)], directed=TRUE, vertices=dt.all.vertices)

# Add weights to the graph & plot
g <- set_edge_attr(g, "weight", value= dt.trade.country.year$trade_value_usd)

plot(g, vertex.size = 5, vertex.label.cex = 0.6)
```


```{r}
dt.trade.year <- dt.trade[year == 2017 & ((reporter_name == 'Afghanistan') | (reporter_name == 'Belgium'))]

dt.trade.edgelist <- dt.trade.year[ , c('reporter_name', 'partner_name')]
class(trade.edgelist)
dt.trade.edgelist

#convert to an igraph network
m.trade <- as.matrix(dt.trade.edgelist) #igraph wants our data in matrix format
class(m.trade)
dim(m.trade)
m.trade[1:10, ]

g.trade <- graph_from_edgelist(m.trade, directed=TRUE)
plot(g.trade, vertex.size = 5, vertex.label = NA, edge.arrow.size=0.4)

```


